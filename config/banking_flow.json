{
    "settings": {
        "start_state": "root"
    },
    "states": {
        "root": {
            "description": "The main menu. The user can ask for banking services.",
            "response_template": "Welcome! How can I help you today?",
            "fallback_behavior": "oos",
            "transitions": [
                {
                    "intent": "check_balance",
                    "target": "view_balance"
                },
                {
                    "intent": "transfer_money",
                    "target": "transfer_flow_start"
                }
            ]
        },
        "view_balance": {
            "description": "Displaying the user's balance.",
            "type": "action",
            "action_name": "get_balance",
            "transitions": {
                "success": "balance_displayed",
                "error": "system_error"
            }
        },
        "balance_displayed": {
            "response_template": "Your balance is ${{balance}}",
            "type": "terminal"
        },
        "transfer_flow_start": {
            "description": "Initiating a money transfer. We need to know who to send it to and how much.",
            "slots_required": [
                "amount",
                "recipient"
            ],
            "slots_optional": [
                "memo"
            ],
            "slot_config": {
                "amount": {
                    "validator": "validate_positive",
                    "enricher": "enrich_amount_of_money"
                }
            },
            "response_prompt": "Ask the user for the amount and recipient. If provided, also capture the memo.",
            "fallback_behavior": "ask_reclassify",
            "transitions": [
                {
                    "intent": "transfer_information",
                    "target": "transfer_confirm",
                    "condition": "all_slots_filled"
                },
                {
                    "intent": "cancel",
                    "target": "root",
                    "context_updates": {
                        "clear_slots": [
                            "amount",
                            "recipient",
                            "memo"
                        ]
                    }
                }
            ]
        },
        "transfer_confirm": {
            "description": "Waiting for user confirmation to execute transfer.",
            "response_template": "Confirm the transfer of {{amount}} to {{recipient}}.",
            "fallback_behavior": "ask_reclassify",
            "transitions": [
                {
                    "intent": "affirmation",
                    "target": "transfer_execute"
                },
                {
                    "intent": "negation",
                    "target": "root"
                }
            ]
        },
        "transfer_execute": {
            "type": "action",
            "action_name": "execute_transfer_func",
            "transitions": {
                "success": "transfer_success",
                "insufficient_funds": "transfer_error_insufficient_funds",
                "error": "transfer_error_state"
            }
        },
        "transfer_error_insufficient_funds": {
            "response_template": "I'm sorry, you don't have enough funds for this transfer.",
            "transitions": [
                {
                    "intent": "affirmation",
                    "target": "root"
                }
            ]
        },
        "transfer_success": {
            "description": "Transfer completed successfully.",
            "response_template": "Success! The money has been sent.",
            "type": "terminal"
        },
        "transfer_error_state": {
            "response_template": "I'm sorry, something went wrong with the transfer. Please try again later.",
            "transitions": [
                {
                    "intent": "affirmation",
                    "target": "root"
                }
            ]
        },
        "system_error": {
            "response_template": "I encountered a system error. Returning to the main menu.",
            "type": "terminal"
        },
        "out_of_scope": {
            "response_template": "I'm sorry, I didn't understand that. Could you please rephrase?",
            "type": "terminal"
        }
    }
}